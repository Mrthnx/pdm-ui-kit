<div [ngClass]="rootClasses" [ngStyle]="rootStyle">
  <div *ngFor="let month of visibleMonths; let monthIndex = index; trackBy: trackByIndex" [ngClass]="monthPanelClasses(monthIndex)">
    <div [ngClass]="headerClasses(month)">
      <button
        *ngIf="month.showPrevButton; else prevPlaceholder"
        type="button"
        [ngClass]="navButtonClasses()"
        aria-label="Previous month"
        (click)="goToPreviousMonth()"
        [disabled]="readonly"
      >
        <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <path d="m15 18-6-6 6-6" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
      </button>
      <ng-template #prevPlaceholder>
        <div [ngClass]="navPlaceholderClasses()" aria-hidden="true"></div>
      </ng-template>

      <ng-container *ngIf="month.titleStyle === 'dropdowns'; else plainTitle">
        <div [ngClass]="dropdownWrapClasses()">
          <div [ngClass]="dropdownClasses('w-[72px]')">
            <select
              [ngClass]="dropdownSelectClasses()"
              [ngStyle]="dropdownSelectStyle"
              [value]="singleHeaderMonth"
              aria-label="Month"
              (change)="onSingleMonthChange($any($event.target).value)"
            >
              <option *ngFor="let monthOption of monthOptions" [value]="monthOption.value">{{ monthOption.label }}</option>
            </select>
            <svg viewBox="0 0 24 24" class="h-3 w-3 text-foreground" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
              <path d="m6 9 6 6 6-6" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
          </div>
          <div [ngClass]="dropdownClasses('w-[82px]')">
            <select
              [ngClass]="dropdownSelectClasses()"
              [ngStyle]="dropdownSelectStyle"
              [value]="singleHeaderYear"
              aria-label="Year"
              (change)="onSingleYearChange($any($event.target).value)"
            >
              <option *ngFor="let year of yearOptions" [value]="year">{{ year }}</option>
            </select>
            <svg viewBox="0 0 24 24" class="h-3 w-3 text-foreground" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
              <path d="m6 9 6 6 6-6" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
          </div>
        </div>
      </ng-container>

      <ng-template #plainTitle>
        <div class="flex min-w-0 flex-1 items-center justify-center">
          <p class="text-foreground text-center text-sm font-medium leading-5">
            {{ month.title }}
          </p>
        </div>
      </ng-template>

      <button
        *ngIf="month.showNextButton; else nextPlaceholder"
        type="button"
        [ngClass]="navButtonClasses()"
        aria-label="Next month"
        (click)="goToNextMonth()"
        [disabled]="readonly"
      >
        <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <path d="m9 18 6-6-6-6" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
      </button>
      <ng-template #nextPlaceholder>
        <div [ngClass]="navPlaceholderClasses()" aria-hidden="true"></div>
      </ng-template>
    </div>

    <div [ngClass]="calendarGridWrapClasses()">
      <div [ngClass]="weekdayRowClasses()">
        <div *ngFor="let day of weekdays; trackBy: trackByIndex" [ngClass]="weekdayCellClasses()">
          <span>{{ day }}</span>
        </div>
      </div>

      <div *ngFor="let week of month.weeks; trackBy: trackByIndex" [ngClass]="weekRowClasses()">
        <div *ngFor="let cell of week; trackBy: trackByDate" [ngClass]="dayCellClasses(cell)">
          <button
            type="button"
            [ngClass]="dayButtonClasses(cell)"
            [disabled]="readonly"
            [attr.aria-selected]="cell.selected"
            [attr.aria-disabled]="cell.disabled || readonly"
            [attr.title]="cell.date | date : 'yyyy-MM-dd'"
            (click)="onDatePressed(cell)"
          >
            <span [ngClass]="dayLabelClasses(cell)">{{ cell.label }}</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
