<section
  [ngClass]="[
    'rounded-lg border border-border bg-background p-3 shadow-sm',
    mode === 'range' ? 'w-full max-w-[520px]' : 'w-[250px]',
    className
  ]"
>
  <div [ngClass]="['grid', mode === 'range' ? 'grid-cols-2 gap-8' : 'grid-cols-1 gap-4']">
    <div class="space-y-4">
      <header class="flex items-center justify-between">
        <button
          type="button"
          class="inline-flex h-8 w-8 items-center justify-center rounded-md text-foreground hover:bg-accent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring/50"
          (click)="previousMonth()"
          aria-label="Previous month"
        >
          <svg viewBox="0 0 16 16" class="h-4 w-4" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M9.5 4L6 8L9.5 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>

        <div *ngIf="mode === 'single'; else rangeLeftHeader" class="flex w-40 items-center justify-center gap-1.5">
          <label class="relative inline-flex h-8 items-center rounded-md border border-border bg-background pl-2 pr-1 text-sm font-medium text-foreground shadow-xs">
            <select
              class="h-full appearance-none bg-transparent pr-4 text-sm font-medium outline-none"
              [value]="month"
              (change)="onMonthSelect($any($event.target).value)"
              aria-label="Month"
            >
              <option *ngFor="let monthOption of monthOptions; let i = index" [value]="i + 1">
                {{ monthOption }}
              </option>
            </select>
            <svg viewBox="0 0 12 12" class="pointer-events-none absolute right-1 h-3 w-3 text-foreground" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M3 4.5L6 7.5L9 4.5" stroke="currentColor" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </label>

          <label class="relative inline-flex h-8 items-center rounded-md border border-border bg-background pl-2 pr-1 text-sm font-medium text-foreground shadow-xs">
            <select
              class="h-full appearance-none bg-transparent pr-4 text-sm font-medium outline-none"
              [value]="year"
              (change)="onYearSelect($any($event.target).value)"
              aria-label="Year"
            >
              <option *ngFor="let yearOption of yearOptions" [value]="yearOption">
                {{ yearOption }}
              </option>
            </select>
            <svg viewBox="0 0 12 12" class="pointer-events-none absolute right-1 h-3 w-3 text-foreground" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M3 4.5L6 7.5L9 4.5" stroke="currentColor" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </label>
        </div>

        <ng-template #rangeLeftHeader>
          <span class="flex-1 text-center text-[14px] font-medium leading-5 text-foreground">
            {{ leftMonthHeading }}
          </span>
        </ng-template>

        <button
          type="button"
          class="inline-flex h-8 w-8 items-center justify-center rounded-md text-foreground hover:bg-accent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring/50"
          (click)="nextMonth()"
          aria-label="Next month"
          [class.invisible]="mode === 'range'"
        >
          <svg viewBox="0 0 16 16" class="h-4 w-4" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M6.5 4L10 8L6.5 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>
      </header>

      <div>
        <div class="grid grid-cols-7 gap-x-1">
          <span *ngFor="let day of weekdays" class="inline-flex h-[21px] items-center justify-center text-[12px] font-normal leading-4 text-muted-foreground">
            {{ day }}
          </span>
        </div>

        <div class="mt-2 grid grid-cols-7 gap-x-1 gap-y-2">
          <button
            *ngFor="let cell of leftCells; trackBy: trackByIndex"
            type="button"
            [ngClass]="[
              'inline-flex h-8 w-8 items-center justify-center justify-self-center rounded-md text-[14px] font-normal leading-5 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring/50',
              cell.outside ? 'text-foreground opacity-50' : 'text-foreground',
              cell.inRange ? 'bg-accent text-accent-foreground' : '',
              cell.selected ? 'bg-primary text-primary-foreground' : '',
              !cell.selected ? 'hover:bg-accent hover:text-accent-foreground' : ''
            ]"
            (click)="selectCell(cell, 'left')"
          >
            {{ cell.day }}
          </button>
        </div>
      </div>
    </div>

    <div *ngIf="mode === 'range'" class="space-y-4">
      <header class="flex h-8 items-center justify-between">
        <span class="flex-1 text-center text-[14px] font-medium leading-5 text-foreground">{{ rightMonthHeading }}</span>
        <button
          type="button"
          class="inline-flex h-8 w-8 items-center justify-center rounded-md text-foreground hover:bg-accent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring/50"
          (click)="nextMonth()"
          aria-label="Next month"
        >
          <svg viewBox="0 0 16 16" class="h-4 w-4" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M6.5 4L10 8L6.5 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>
      </header>

      <div>
        <div class="grid grid-cols-7 gap-x-1">
          <span *ngFor="let day of weekdays" class="inline-flex h-[21px] items-center justify-center text-[12px] font-normal leading-4 text-muted-foreground">
            {{ day }}
          </span>
        </div>

        <div class="mt-2 grid grid-cols-7 gap-x-1 gap-y-2">
          <button
            *ngFor="let cell of rightCells; trackBy: trackByIndex"
            type="button"
            [ngClass]="[
              'inline-flex h-8 w-8 items-center justify-center justify-self-center rounded-md text-[14px] font-normal leading-5 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring/50',
              cell.outside ? 'text-foreground opacity-50' : 'text-foreground',
              cell.inRange ? 'bg-accent text-accent-foreground' : '',
              cell.selected ? 'bg-primary text-primary-foreground' : '',
              !cell.selected ? 'hover:bg-accent hover:text-accent-foreground' : ''
            ]"
            (click)="selectCell(cell, 'right')"
          >
            {{ cell.day }}
          </button>
        </div>
      </div>
    </div>
  </div>
</section>
